

from threading import Thread

import pandas as pd
from pyarrow.pandas_compat import _pandas_api

if __name__ == "__main__":
    wait = True
    num_threads = 10
    df = pd.DataFrame()
    results = []

    def rc():
        while wait:
            pass
        results.append(_pandas_api.is_data_frame(df))

    threads = [Thread(target=rc) for _ in range(num_threads)]

    for t in threads:
        t.start()

    wait = False

    for t in threads:
        t.join()

    assert len(results) == num_threads
    assert all(results), "`is_data_frame` returned False when given a DataFrame"
