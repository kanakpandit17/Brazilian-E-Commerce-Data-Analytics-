
import pyarrow.fs


def application(env, start_response):
    path = env['PATH_INFO']
    members = path.split('/')
    assert members[0] == ''
    assert len(members) >= 2
    root = members[1]
    if root == 's3':
        start_response('200 OK', [('Content-Type', 'text/html')])
        fs = pyarrow.fs.S3FileSystem()
        return [b"Hello World\n"]
    else:
        start_response('404 Not Found', [('Content-Type', 'text/html')])
        return [f"Path {path!r} not found\n".encode()]
